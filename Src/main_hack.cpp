/****************************************************************************************
* File: main_hack.cpp
*
* Description: Configures and starts the Quadcopter
* main.c is generated by STM32CubeMX, so we need the actual main file to be named differently
*
* Created by Matt Olson
****************************************************************************************/

/*---------------------------------------------------------------------------------------
*                                       INCLUDES
*--------------------------------------------------------------------------------------*/
#include "main.h"
#include "led.h"

/*---------------------------------------------------------------------------------------
*                                   LITERAL CONSTANTS
*--------------------------------------------------------------------------------------*/

/*---------------------------------------------------------------------------------------
*                                        TYPES
*--------------------------------------------------------------------------------------*/

/*---------------------------------------------------------------------------------------
*                                   MEMORY CONSTANTS
*--------------------------------------------------------------------------------------*/

/*---------------------------------------------------------------------------------------
*                                      VARIABLES
*--------------------------------------------------------------------------------------*/

/*---------------------------------------------------------------------------------------
*                                     PROCEDURES
*--------------------------------------------------------------------------------------*/

/*****************************************************************************
* Function: main
*
* Description: The main loop of the quadcopter
*****************************************************************************/
int main(void)
{
  /* MCU Configuration--------------------------------------------------------*/
  InitHardware();

  /* Reset of all peripherals, Initializes the Flash interface and the Systick. */
  HAL_Init();

  /* Initialize all configured peripherals */
  LED green_led(GPIOD, GPIO_PIN_12);
  LED orange_led(GPIOD, GPIO_PIN_13);
  LED red_led(GPIOD, GPIO_PIN_14);
  LED blue_led(GPIOD, GPIO_PIN_15);

  LED* leds[4] = { &green_led, &orange_led, &red_led, &blue_led };
  int led_num = 0;
  /* Infinite loop */
  while (true)
  {
    for(int i = 0; i < 1000000; i++) 
    {
    }

    leds[led_num]->Off();
    led_num = (led_num + 1) % 4;
    leds[led_num]->On();
  }
}
